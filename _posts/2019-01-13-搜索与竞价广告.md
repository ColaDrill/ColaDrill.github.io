---
layout:     post
title:      搜索与竞价广告
subtitle:   《计算广告学》第五章
date:       2019-01-13
author:     Jiayue Cai
header-img: img/post-bg-black.jpg
catalog: true
tags:
    - Computational Advertising
---


> Last updated on 2019-01-13... 

未完待续...
	
### 竞价广告关系图

![](/img/post/20190113/1.jpg)

竞价交易模式的`本质`：将量的约束从交易过程中去除。

### 搜索广告

**具体产品形态**：以上下文查询词为粒度进行受众定向。

**技术特点**：变现能力高、受众定下标签明显（上下文）、展示形式接近自然结果。

**新形势**：
- 丰富文字链创意
- 利用东区对相关性要求较低的特点设计一些拓展广告产品
- 优化广告和自然结果的关系，在保证相关性和广告效果的前提下提高收入

**产品策略**：

![](/img/post/20190113/2.jpg)

- 查询扩展：精确匹配；短语匹配；广泛匹配；否定匹配
- 广告放置：设定北区和东区的进入条件：广告相关性和RPM。

> 产品案例：`Google AdWords`、`淘宝直通车`

### 位置拍卖与机制设计

以搜索广告为代表的竞价广告实际上是像拍卖那样销售广告展示机会。也就是说，系统根据广告主的出价以及由此计算出的 eCPM 决定谁可以得到某次展示的广告位。
- 竞价广告初始阶段：出价是广告主阶段性调整的
- 广告实时交易阶段：广告主可以对每次展示实时调整出价（实时竞价将在第 6 章中介绍）。但是从拍卖市场的宏观角度看，这两种竞价没有本质差别

让我们先来看看怎样描述竞价广告问题，并从宏观市场的角度了解一些重要结论。如下图所示，假设有一组广告位可以被占用，将这些广告位按照其经验价值排名，分别记为 s=1，2，···，S（对横幅广告而言，这里的 S 一般为 1）。

在某次广告请求中，有一组广告 a=1，2，···，A 出价参与拍卖，每个广告的出价记为 b<sub>a</sub>，系统将前 S 个高出价的广告依次放到前面排序好的 S 个广告位上，这样的问题称为位置拍卖（position auction）。

根据前文的讨论，当某个广告 a 被放在 s 位置上时，其**期望收益**即`eCPM`为 r<sub>as</sub>=µ<sub>s</sub>ν<sub>a</sub>。

这里我们作了一些**假设**，比如，`点击率 µ`仅与`位置 s`有关，而`点击价值 ν`仅与`广告 a`有关，这些假设在搜索广告给定某具体关键词的情形下可以说基本合理，对于展示广告的情形虽然非常近似，但并不太影响对竞价问题宏观市场的讨论。

**位置拍卖问题示例图**：

![](/img/post/20190113/3.png)

#### 定价问题

在定价问题上，我们在微观上的直觉未必可以推广到宏观市场。从整个市场的角度来看，我们重点需要研究的是市场处于`稳定状态`下的收益和其他特性。

而所谓`稳定`，指的是整个竞价系统处于`纳什均衡（Nash equilibrium）状态`，也即每个广告主都通过出价得到了最符合自己利益的位置。

对某一次位置竞价来说，其对称`纳什均衡（symmetric Nashequilibrium）状态`可以表示为下式：

![](/img/post/20190113/4.png)

在线广告竞价市场最常见的定价策略是 GSP （广义第二高价）方案；另外有一种 VCG（Vickrey-Clarke-Groves）定价策略。

#### GSP

**第二高价**：指的是在只有一个位置的拍卖中，向赢得该位置的广告主收取其下一位广告主的出价，这样的拍卖也叫作 Vickrey拍卖。

**广义第二高价**：在搜索广告这种有多个位置的拍卖过程中，很容易直觉地将第二高价策略推广成下面的策略：对赢得每一个位置的广告主，都按照他下一位的广告位置出价来收取费用。

如果是按照 CPM 结算，那么广义第二高价可以非常直接地应用。

然而在 CPC 结算的竞价广告系统中，广告主的出价是针对点击的，而竞价是针对 eCPM 的，因此要对两者换算一下以实现 CPC 情形下的广义第二高价，其定价公式如下：

![](/img/post/20190113/5.png)

#### VCG

VCG 定价是 Vickrey、Clarke 和 Groves 在研究竞价系统均衡状态时得到的一种理论上较为优越的定价策略。

其基本思想是：对于赢得了某个位置的广告主，其所付出的成本应该等于他占据这个位置给其他市场参与者带来的价值损害。

在这一原则下，VCG的定价策略可以表示为公式：

![](/img/post/20190113/6.png)

#### 对比分析

虽然理论上比 GSP 更合理，但是由于原理较复杂，向广告主解释起来有难度，因此在实际系统中采用的并不多。

VCG定价策略直觉上的合理性很容易理解。理论分析表明，VCG 定价策略的优越性体现在如下几个方面：
- 首先，在这种定价策略的稳定状态下，整个市场是 truth-telling 的。所谓 truth-telling，可以理解为每个广告主都找到了自己的最优状态
- 其次，相对于其他的定价策略，这种定价向广告主收取的费用是最少的。在单广告位拍卖的情形下，VCG 定价策略就退化为第二高价策略

虽然有以上诸多的优点，VCG 定价在竞价广告中却并不是一种主流的方式。
- 这主要是由于这种定价方式的逻辑过于复杂，比较难以向广告主解释清楚
- 另外在广告主和媒体存在博弈关系的情形下，媒体是否正确地计算了“给其他市场参与者带来的价值损害”也很难验证

> 不过VCG这种定价方法也有其市场空间，有些广告厂商，如 Facebook，在实际的竞价广告系统中就采用了这一定价机制。

#### 价格挤压

能够根据市场情况更主动地影响竞价体系向着需要的方向发展。

在 CPC 结算的广告产品中，eCPM 可以表示成点击率和出价的乘积，即 r=µ·ν=µ·bid CPC 。但是在竞价的机制设计中，有时会对此公式做一些微调，把它变成下面的形式：

![](/img/post/20190113/7.png)

其中的κ为一个大于 0 的实数。可以考虑两种极端情况来理解κ的作用：
- 当κ→∞时，相当于只根据点击率来排序而不考虑出价的作用
- 当κ→0时，则相当于只根据出价来排序

因此，随着κ的增大，相当于我们在挤压出价在整个竞价体系中的作用，因此我们把这个因子叫做价格挤压（squashing）因子。

#### 定价结果示例

![](/img/post/20190113/8.png)

从上表的例子中可以看出，经过GSP 的 CPC 定价并不是降序的，并且存在低于 MRP（如第 3 位的广告）的情形，这时需要将其强制设为 MRP；另外，κ会对排序和计价都有明显的影响。

#### 代码描述

上节介绍了位置拍卖市场中一些常用的定价策略，包括 GSP、MRP、价格挤压等，单独理解这些策略都不困难。

在实际的系统中，需要将这几种策略综合起来执行。以按 CPC计价的竞价广告产品中一次广告展示为例，我们将实际的计价算法用下面的代码描述：

![](/img/post/20190113/9.png)






