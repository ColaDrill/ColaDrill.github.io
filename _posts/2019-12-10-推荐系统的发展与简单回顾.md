---
layout:     post
title:      推荐系统的发展与简单回顾
subtitle:   表示学习、深度学习、强化学习、知识图谱
date:       2019-12-10
author:     Jiayue Cai
header-img: img/post-bg-debug.png
catalog: true
tags:
    - Recommending System
---

> Last updated on 2019-12-10... 

结合百度和支付宝两段推荐系统相关的实习经历，本篇针对工业界的模型发展做了简单梳理与回顾。

### 表示学习

> [美团王永康前辈的分享](https://blog.csdn.net/gamer_gyt/article/details/97985818)

常用类别特征的表示方法：One-Hot Encoding、Look-Up Embedding、Pre-Train Embedding

#### 框架

![](/img/post/20191210/1.png)

#### 序列 Sequence

![](/img/post/20191210/2.png)

#### 图 Graph

![](/img/post/20191210/3.png)

#### 附加信息 Side Information

Side Information框架是解决冷启动的方法之一。

![](/img/post/20191210/4.png)

#### 多模态 Multimodal

> [优酷在多模态内容理解上的研究及应用](https://www.infoq.cn/article/xgP_eyfidAA2l5ShcCPp)

![](/img/post/20191210/5.png)

#### 模型层面的应用

此部分详细内容参考下节。

![](/img/post/20191210/6.png)


### 深度学习

![](/img/post/20191210/7.png)

企业级的推荐系统为了尽量提高模型的准确性，往往会使用丰富的甚至异构的内容数据。这些特征从不同的维度展现了不同的信息，而且特征间的组合通常是非常有意义的。传统的交叉特征是由工程师手动设计的，这有很大的局限性，成本很高，并且不能拓展到未曾出现过的交叉模式中。因此学者们开始研究用神经网络去自动学习高阶的特征交互模式，弥补人工特征工程带来的种种局限性。

> [基于深度学习的推荐系统综述](https://coladrill.github.io/2018/08/08/%E5%9F%BA%E4%BA%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E7%BB%BC%E8%BF%B0/)、[Github链接](https://github.com/shenweichen/DeepCTR)

![](/img/post/20191210/8.png)

#### 2015-2016

- **Convolutional Click Prediction Model**	[CIKM 2015]A Convolutional Click Prediction Model
- **Factorization-supported Neural Network**	[ECIR 2016]Deep Learning over Multi-field Categorical Data: A Case Study on User Response Prediction
- **Product-based Neural Network**	[ICDM 2016]Product-based neural networks for user response prediction

#### 2016-2018

- **Wide & Deep**	[DLRS 2016]Wide & Deep Learning for Recommender Systems
- **DeepFM**	[IJCAI 2017]DeepFM: A Factorization-Machine based Neural Network for CTR Prediction
- **Piece-wise Linear Model**	[arxiv 2017]Learning Piece-wise Linear Models from Large Scale Data for Ad Click Prediction
- **Deep & Cross Network**	[ADKDD 2017]Deep & Cross Network for Ad Click Predictions
- **Attentional Factorization Machine**	[IJCAI 2017]Attentional Factorization Machines: Learning the Weight of Feature Interactions via Attention Networks
- **Neural Factorization Machine**	[SIGIR 2017]Neural Factorization Machines for Sparse Predictive Analytics
- **xDeepFM**	[KDD 2018]xDeepFM: Combining Explicit and Implicit Feature Interactions for Recommender Systems

#### 2018-2019

- **AutoInt**	[arxiv 2018]AutoInt: Automatic Feature Interaction Learning via Self-Attentive Neural Networks
- **Deep Interest Network**	[KDD 2018]Deep Interest Network for Click-Through Rate Prediction
- **Deep Interest Evolution Network**	[AAAI 2019]Deep Interest Evolution Network for Click-Through Rate Prediction
- **NFFM**	[arxiv 2019]Operation-aware Neural Networks for User Response Prediction
- **FGCNN**	[WWW 2019]Feature Generation by Convolutional Neural Network for Click-Through Rate Prediction
- **Deep Session Interest Network**	[IJCAI 2019]Deep Session Interest Network for Click-Through Rate Prediction
- **FiBiNET**	[RecSys 2019]FiBiNET: Combining Feature Importance and Bilinear feature Interaction for Click-Through Rate Prediction


### 强化学习

用户与推荐系统之间往往会发生持续密切的交互行为，强化学习中的Reward机制十分适合应用到这种模式，所以基于强化学习的推荐方法中，往往会把推荐系统看做智能体（Agent）、把用户看做环境（Environment），商品的推荐问题可以看做经典的顺序决策问题。Agent每一次排序策略的选择可以看做一次试错（Trial and Error），把用户的反馈、点击成交等作为从环境中获得的奖赏。

在支付宝实习的时候，优化CTR模型之余，针对商家线下运营策略推荐场景，主导实现了off-policy的强化学习模型（下图仅作抛砖引玉，模型细节不能公布哈）。

![](/img/post/20191210/9.png)

![](/img/post/20191210/10.png)

#### 论文整理

未完待续...（近期我会整理一些强化学习模型放在该章节）
- DRN:A Deep Reinforcement Learning Framework for News Recommendation
- Top-K Off-Policy Correction for a REINFORCE Recommender System

#### 机遇与挑战

现行主流的深度强化学习算法都试图避开对环境的建模，而直接进行策略学习（即 model-free）。这就要求海量的经验数据以获取最优的推荐策略。然而，推荐场景下的可获取的交互数据往往规模有限且奖励信号稀疏（reward-sparsity），这就使得简单地套用既有算法难以取得令人满意的实际效果。如何运用有限的用户交互得到有效的决策模型将是算法进一步提升的主要方向。

此外，现实中人们往往需要对不同推荐场景进行独立的策略学习。不同场景下的策略互不相同，这就使得人们不得不花费大量精力以对每个场景都进行充分的数据采集。同时，由于不具备通用性，既有策略难以迅速适应新的推荐场景。面对这些挑战，人们需要尽可能地提出通用策略的学习机制，以打通算法在不同推荐场景间的壁垒，并增强其在变化场景中的鲁棒性。


### 知识图谱

> [Personalized Recommendation Systems: Five Hot Research Topics You Must Know](https://www.microsoft.com/en-us/research/lab/microsoft-research-asia/articles/personalized-recommendation-systems/)

在多数推荐场景中，物品可能包含丰富的知识信息，而刻画这些知识的网络结构即被称为知识图谱。物品端的知识图谱极大地扩展了物品的信息，强化了物品之间的联系，为推荐提供了丰富的参考价值，更能为推荐结果带来额外的`多样性`和`可解释性`。

![](/img/post/20191210/11.png)

和社交网络相比，知识图谱是一种异构网络，因此针对知识图谱的推荐算法设计要更复杂和精巧。近年来，网络特征学习 (network representation learning) 逐渐成为机器学习中的一个热门的研究方向。
引入网络特征学习的方法处理推荐系统中知识图谱的相关信息，有助于增强推荐系统的学习能力，提高精确度和用户满意度。

#### 基于特征

核心是知识图谱特征学习的引入。

一般而言，知识图谱是一个由三元组 `< 头节点，关系，尾节点 >` 组成的异构网络。由于知识图谱天然的高维性和异构性，首先使用知识图谱特征学习对其进行处理，从而得到实体和关系的低维稠密向量表示。这些低维的向量表示可以较为自然地与推荐系统进行结合和交互。

在这种处理框架下，推荐系统和知识图谱特征学习事实上就成为两个相关的任务。而依据其训练次序不同，又有两种结合形式：
- 知识图谱特征与推荐系统依次进行学习，即先学习特征，再将所学特征用于推荐。
- 交替学习法，将知识图谱特征学习和推荐系统视为两个相关的任务，设计一种多任务学习框架，交替优化二者的目标函数, 利用知识图谱特征学习任务辅助推荐系统任务的学习。

#### 基于结构

更加直接地使用知识图谱的结构特征。

具体来说，对于知识图谱中的每一个实体，我们都进行宽度优先搜索来获取其在知识图谱中的多跳关联实体从中得到推荐结果。根据利用关联实体的技术的不同，可分向外传播法和向内聚合法两种方法：
- 向外传播法模拟了用户的兴趣在知识图谱上的传播过程。[RippleNet](https://arxiv.org/pdf/1803.03467.pdf)使用了向外传播法，将每个用户的历史兴趣作为知识图谱上的种子集合，沿着知识图谱中的链接迭代地向外扩展。
- 向内聚合法在学习知识图谱实体特征的时候聚合了该实体的邻居特征表示。通过邻居聚合的操作，每个实体的特征的计算都结合了其邻近结构信息，且权值是由链接关系和特定的用户决定的，这同时刻画了知识图谱的语义信息和用户的个性化兴趣。

#### 机遇与挑战

将推荐算法与知识图谱的图计算方法相结合已逐渐成为学术热点，前景广阔。然而现有方法仍有一定局限，有充分的研究空间。
- 现有模型都属于统计学习模型，即挖掘网络中的统计学信息并以此进行推断。一个困难但更有研究前景的方向是在网络中进行推理，将`图推理`与推荐系统相结合。
- 如何设计出性能优秀且运行效率高的算法，也是潜在的研究方向。现有模型并不涉及`计算引擎层面`、`系统层面`甚至`硬件层面`的考量，如何将上层算法和底层架构进行联合设计和优化，是实际应用中一个亟待研究的问题。
- 现有的模型网络结构都是静态的，在真实场景中，知识图谱具有一定的时效。如何刻画这种时间演变的网络，并在推荐时充分`考虑时序信息`，也值得我们未来研究。













