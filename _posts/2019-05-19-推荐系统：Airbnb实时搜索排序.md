---
layout:     post
title:      推荐系统：Airbnb实时搜索排序
subtitle:   Embedding技巧、点击序列、预订序列
date:       2019-05-19
author:     Jiayue Cai
header-img: img/post-bg-black.jpg
catalog: true
tags:
    - Recommending System
---

> Last updated on 2019-5-19... 

> KDD 2018 Best Paper[《Real-time Personalization using Embeddings for Search Ranking at Airbnb》](https://astro.temple.edu/~tua95067/kdd2018.pdf)

### 场景

Airbnb作为全世界最大的短租网站，提供了一个连接房主（host）挂出的短租房（listing）和主要是以旅游为目的的租客（guest/user）的中介平台。这样一个中介平台的交互方式比较简单，guest输入地点，价位，关键词等等，Airbnb会给出listing的搜索推荐列表。

Airbnb上预订是双向选择的过程：客户如果想预订房源，还要看房东是否同意。
![](/img/post/20190519/1.png)

总之，guest和host之间的`交互方式`有以下几种：
- guest点击listing （click）
- guest预定lising （book）
- host有可能拒绝guest的预定请求 （reject）

为了进行更加准确的排序，Airbnb的搜索团队建立了一个Real-time实时的个性化排序模型，既考虑用户的短时兴趣，也考虑用户的长期兴趣。
- `短时兴趣`指用户在一个session中表现出的兴趣（点击序列）
- `长期兴趣`指用户在其所有历史行为中表现出的兴趣（预订序列）

在模型中，其精髓就在于Embedding的过程，包括Listing Embedding、User Type & Listing Type Embedding。

### Listing Embedding

对房源进行Embedding，可以建模用户的短时兴趣，也可以进行相似房源的推荐。它通过用户在Session中的点击序列训练得到，这里的session定义要注意以下两点：
- 一个是只有停留时间超过30s的listing page才被算作序列中的一个数据点
- 二是如果用户超过30分钟没有动作，那么这个序列会断掉，不再是一个序列。

> 作用:清洗噪声点和负反馈信号，同时避免非相关序列的产生













